pluginManagement {
    // Ensure plugin repositories are available to resolve plugins via the plugins DSL
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
        // Flutter Maven repo for io.flutter artifacts
        maven { url 'https://storage.googleapis.com/download.flutter.io' }
    }
    // No explicit versions in settings; plugins block can be omitted to avoid conflicts.
}

// Read flutter.sdk from local.properties for local plugin resolution
def flutterSdk = null
def localPropertiesFile = new File(rootDir, "local.properties")
if (localPropertiesFile.exists()) {
    def Properties p = new Properties()
    localPropertiesFile.withInputStream { is -> p.load(is) }
    def lpFlutter = p.getProperty("flutter.sdk")
    if (lpFlutter != null && !lpFlutter.trim().isEmpty()) {
        flutterSdk = lpFlutter
    }
}

// Include Flutter tools Gradle build to resolve dev.flutter.flutter-gradle-plugin locally
if (flutterSdk != null && new File(flutterSdk).exists()) {
    includeBuild("${flutterSdk}/packages/flutter_tools/gradle")
} else {
    println("Warning: Flutter SDK path not found in local.properties (flutter.sdk). Set it to enable dev.flutter.flutter-gradle-plugin.")
}

dependencyResolutionManagement {
    // Prefer project-level repositories to allow plugin-added repos (e.g., Flutter)
    repositoriesMode.set(RepositoriesMode.PREFER_PROJECT)
    repositories {
        google()
        mavenCentral()
        // Flutter Maven repo for io.flutter artifacts
        maven { url 'https://storage.googleapis.com/download.flutter.io' }
    }
}

rootProject.name = "MobileApp"
include(":app")
